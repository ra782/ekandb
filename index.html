<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>合格発表シミュレーター</title>
</head>
<body>
  <h1>合格発表シミュレーター</h1>
  <form id="simulatorForm">
    <label>受験人数:
      <input type="number" id="totalCandidates" required>
    </label>
    <br>
    <label>合格者数:
      <input type="number" id="passCount" required>
    </label>
    <br>
    <label>受験番号開始 (例: M1001 または 1001):
      <input type="text" id="startNumber" required>
    </label>
    <br>
    <label>受験番号終了 (例: M1233 または 1233):
      <input type="text" id="endNumber" required>
    </label>
    <br>
    <button type="submit">合格者を決定</button>
  </form>
  
  <h2>合格発表結果</h2>
  <pre id="result"></pre>

  <script>
    // 受験番号を生成する関数（数字だけの場合も対応）
    function generateNumbers(startStr, endStr) {
      // 先頭の文字部分を抽出。数字のみの場合はnullなので、空文字とする
      const startMatch = startStr.match(/^[^\d]+/);
      const endMatch = endStr.match(/^[^\d]+/);
      let prefix = "";
      if (startMatch && endMatch) {
        if (startMatch[0] !== endMatch[0]) {
          alert("開始番号と終了番号の接頭辞が一致していません。");
          return [];
        }
        prefix = startMatch[0];
      } else if (startMatch === null && endMatch === null) {
        prefix = "";
      } else {
        alert("開始番号と終了番号の形式が一致していません。");
        return [];
      }
      
      // 数字部分を取得
      const startNum = parseInt(startStr.replace(/^[^\d]+/, ''));
      const endNum = parseInt(endStr.replace(/^[^\d]+/, ''));
      
      const numbers = [];
      for (let i = startNum; i <= endNum; i++) {
        numbers.push(prefix + i);
      }
      return numbers;
    }

    // 配列からランダムに重複なく要素を抽出する関数
    function getRandomUniqueElements(arr, count) {
      const result = [];
      const copy = [...arr];
      for (let i = 0; i < count; i++) {
        const randIndex = Math.floor(Math.random() * copy.length);
        result.push(copy[randIndex]);
        copy.splice(randIndex, 1);
      }
      return result;
    }

    // フォームの送信処理
    document.getElementById('simulatorForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const totalCandidates = parseInt(document.getElementById('totalCandidates').value);
      const passCount = parseInt(document.getElementById('passCount').value);
      const startNumber = document.getElementById('startNumber').value.trim();
      const endNumber = document.getElementById('endNumber').value.trim();

      // 受験番号リストを生成
      const numbers = generateNumbers(startNumber, endNumber);
      if (numbers.length === 0) {
        return;
      }

      // 入力された受験人数と生成された番号の個数が一致するか確認
      if (numbers.length !== totalCandidates) {
        alert("入力した受験人数と受験番号の範囲が一致しません。");
        return;
      }
      
      if (passCount > totalCandidates) {
        alert("合格者数は受験人数より多くなりません。");
        return;
      }

      // ランダムに合格者を抽出
      const selected = getRandomUniqueElements(numbers, passCount);
      // 数字部分で昇順に並び替え
      selected.sort((a, b) => {
        const numA = parseInt(a.replace(/^[^\d]+/, ''));
        const numB = parseInt(b.replace(/^[^\d]+/, ''));
        return numA - numB;
      });

      // 結果を表示（各番号を改行して出力）
      document.getElementById('result').textContent = selected.join("\n");
    });
  </script>
</body>
</html>